<!DOCTYPE html>
<html>
  <head>
  <meta charset="utf-8">

<script src="/socket.io/socket.io.js"></script>


</head>
	
    <h1>Summoner Wars</h1>

	<div id='page_content'>
	
	</div>

      <script type="text/javascript">
      
                 
        var socket = io.connect(window.location.hostname);

        /**************************************************
        ** APPLICATION VARIABLES
        **************************************************/

        var page_content = document.getElementById('page_content');
        var briefing_section = document.getElementById('briefing_section');
        var player_login = ""; //store player login after typing
        var room_name = "";    //room name that player joined

        /**************************************************
        ** APPLICATION FUNCTIONS
        **************************************************/


        var rebuildLoginSection = function() 
            {
               //firsly remove old login section 
               removeLoginSection();
               
               //then build new one
               var new_section = document.createElement('div');
               new_section.setAttribute('id', 'login_section');
               
               //<p>
               var p = document.createElement('p');
               p.innerHTML = "Put your name:";
               new_section.appendChild(p);
               //<br>
               var br = document.createElement('br');
               new_section.appendChild(br);
               //<input type="text">
               var btn = document.createElement('input');
               btn.setAttribute('type', 'text');
               btn.setAttribute('id', 'txt_login');
               new_section.appendChild(btn);
               //<br>
               var br = document.createElement('br');
               new_section.appendChild(br);
               //<input type="button">
               var btn = document.createElement('input');
               btn.setAttribute('type', 'button');
               //btn.setAttribute('id', 'btn_join_game');
	           
	           btn.addEventListener('click', function() 
                          { 
                          
                          rebuildBriefingSection();
                          
                          player_login = document.getElementById('txt_login').value;
                          player_login = player_login.trim();
                          if(player_login === "") 
                             {
                             //TODO change alert to dialog
                             alert("login is empty!" + player_login);
                             return;
                             }
                             
                          removeLoginSection();
                          socket.emit('add_new_player', { login: player_login });
                          //LUCN rebuildBriefingSection();
                          }, true);
               
               new_section.appendChild(btn);
               //add to page content
               page_content.appendChild(new_section);
            }

        var removeLoginSection = function()
            {
               var old_section = document.getElementById('login_section');
               if(old_section != undefined)
                  {
                  page_content.removeChild(old_section);
                  }
            } 
            
       


        
        /**************************************************
        ** EVENTS HANDLING
        **************************************************/

        var setEventHandlers = function() {

		
           socket.on('connection_confirmation', function () 
                {

                            rebuildLoginSection();
                           
           });

	   }


    setEventHandlers();

     </script>

	
  </body>


</html>
